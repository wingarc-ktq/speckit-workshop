# Day 2: タスク分解と実装

## 🎯 今日のゴール

Day 1で作成したFigmaデザインを元に、spec-kitのワークフローでタスク分解し、Reactコンポーネントを実装する。

**成果物**

- タスク一覧（tasks.md）
- 動作するReactコンポーネント（MVP機能）
- モックAPIとの接続

---

## ⏰ タイムテーブル（6時間）

| 時間        | 内容                          |
| ----------- | ----------------------------- |
| 10:00-10:30 | Day 1振り返り・環境確認       |
| 10:30-11:30 | `/speckit.tasks` でタスク分解 |
| 11:30-12:30 | `/speckit.implement` で実装   |
| 12:30-13:30 | 休憩                          |
| 13:30-15:30 | `/speckit.implement` で実装   |
| 15:30-16:00 | 動作確認・デバッグ            |
| 16:00-17:00 | レビュー・振り返り            |

---

## 📋 事前準備チェックリスト

- [ ] Day 1のFigmaデザインが完成している
- [ ] FigmaファイルのURLを控えている
- [ ] plan.mdが完成している

---

## 1️⃣ プロジェクト構成の確認（30分）

### 1.1 ディレクトリ構造

```
src/
├── adapters/          # API通信層
│   └── api/
│       └── files/     # ファイルAPI
├── domain/            # ドメインロジック
│   └── files/
├── presentations/     # UI層
│   ├── components/    # 共通コンポーネント
│   ├── pages/         # ページコンポーネント
│   └── layouts/       # レイアウト
├── app/               # アプリ設定
└── i18n/              # 国際化
```

### 1.2 使用する主要ライブラリ

| ライブラリ        | 用途                       |
| ----------------- | -------------------------- |
| React 19          | UIフレームワーク           |
| MUI (Material UI) | UIコンポーネント           |
| TanStack Query    | データフェッチ・キャッシュ |
| React Router v6   | ルーティング               |
| Orval             | OpenAPIからの型生成        |

### 1.3 OpenAPI仕様の確認

`schema/files/openapi.yaml` を確認し、使用するAPIを把握します。

**主要エンドポイント**

```yaml
GET    /files          # ファイル一覧取得
POST   /files          # ファイルアップロード
GET    /files/{fileId} # ファイル詳細取得
PUT    /files/{fileId} # ファイル更新
DELETE /files/{fileId} # ファイル削除
GET    /tags           # タグ一覧取得
POST   /tags           # タグ作成
```

### 1.4 型の生成（Orval）

OpenAPIから型とAPIクライアントを生成します。

```bash
pnpm gen:api
```

**生成されるファイル**

- `src/adapters/generated/files.ts` - API型定義とクライアント関数

これらのファイルには、OpenAPI仕様から自動生成された型やAPIクライアント関数が含まれます。

---

## 2️⃣ `/speckit.tasks` でタスク分解（1時間）

### 2.1 タスク分解の実行

プランを元に、具体的なタスクに分解します。

**Copilot Chatでの実行例**

```
/speckit.tasks
```

### 2.2 タスクの確認

分解されたタスクを確認し、必要に応じて修正します。

---

## 3️⃣ `/speckit.implement` で実装（2時間）

### 3.1 実装の開始

タスクIDやPhase番号を指定して、一つずつ実装していきます。

`/speckit.implement`は、コンポーネント実装と同時に単体テストも自動生成します。

**実行例1: タスクIDで指定**

```
/speckit.implement

T001を実装してください。
```

**生成されるファイル例**

- `src/presentations/pages/FilePage/FilePage.tsx` - コンポーネント本体
- `src/presentations/pages/FilePage/__tests__/FilePage.test.tsx` - 単体テスト

**実行例2: Phase番号で指定**

```
/speckit.implement

Phase 1の全タスクを実装してください。
```

**実行例3: Figmaデザインを参照**

```
/speckit.implement

T005を実装してください。
以下のFigma URLからデザイン情報を参照してください。

Figma URL: [あなたのFigma URL]
```

**実行例4: 複数タスクを並列実装**

```
/speckit.implement

T002とT003を並列で実装してください。
```

### 3.2 テストの確認

実装後、生成された単体テストを実行して動作を確認します。

```bash
# すべてのテストを実行
pnpm test:run

# ウォッチモードで実行（開発中）
pnpm test

# カバレッジを確認
pnpm test:coverage
```

---

## 4️⃣ 難易度別の追加課題

### 🟢 基本（必須）

- [ ] 文書一覧（リストビュー）の表示
- [ ] リスト/グリッド切り替え
- [ ] 検索バーの実装
- [ ] ページネーション

### 🟡 標準

- [ ] ソート機能の実装
- [ ] アップロードモーダル
- [ ] ドラッグ&ドロップ
- [ ] プログレスバー

### 🔴 発展

- [ ] タグフィルター
- [ ] 検索キーワードのハイライト
- [ ] キーボードショートカット
- [ ] Optimistic Update

---

## 5️⃣ 動作確認・デバッグ（30分）

### 6.1 動作確認チェックリスト

```bash
# 開発サーバー起動
pnpm dev

# ブラウザで確認
open http://localhost:5173
```

**確認項目**

- [ ] 文書一覧が表示される
- [ ] リスト/グリッド切り替えが動作する
- [ ] 検索で絞り込める
- [ ] ページネーションが動作する
- [ ] コンソールにエラーがない

### 6.2 Lintとテスト

```bash
# Lintチェック
pnpm lint

# テスト実行
pnpm test:run

# 型チェック
pnpm type-check
```

---

## 7️⃣ レビュー（1時間）

### レビューの進め方

1. 画面共有で動作デモ（3分/人）
2. コードの工夫点を説明（2分/人）
3. 質問・フィードバック（10分/人）

### レビュー観点

- [ ] MVP機能が動作するか
- [ ] コンポーネントの責務は明確か
- [ ] カスタムフックで適切に分離されているか
- [ ] 型定義は適切か

---

## 📝 Day 2 振り返りチェックリスト

- [ ] プロジェクト構成を理解できた
- [ ] `/speckit.tasks` でタスク分解できた
- [ ] `/speckit.implement` で実装できた
- [ ] MVP機能が動作する状態になった
- [ ] Lintエラーがない

---

## ➡️ 次回予告: Day 3

Day 3では、Playwright MCPを使用してE2Eテストを作成します。

**事前準備**

- [ ] 今日の実装を完成させておく
- [ ] テスト対象の画面URLを確認しておく
- [ ] Playwrightの基本を予習（任意）
